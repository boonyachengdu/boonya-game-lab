<!-- test-api.html -->
<!DOCTYPE html>
<html>
<head>
    <title>API 测试页面</title>
</head>
<body>
<h1>RAG API 测试</h1>

<div>
    <a class="nav-link text-white" href="javascript:void(0)">
        <i class="fas fa-comments me-1"></i>返回聊天
    </a>
    <span th:text="${username}">用户</span>
    <input type="hidden" id="sessionId" th:value="${sessionId}">
    <button onclick="testHealth()">测试健康检查</button>
    <button onclick="testAsk()">测试问答接口</button>
</div>

<div id="result" style="margin-top: 20px; padding: 10px; border: 1px solid #ccc;"></div>

<script>
    async function testHealth() {
        try {
            const response = await fetch('/api/rag/health');
            const data = await response.json();
            document.getElementById('result').innerHTML =
                '<pre>' + JSON.stringify(data, null, 2) + '</pre>';
        } catch (error) {
            document.getElementById('result').innerHTML =
                '错误: ' + error.message;
        }
    }

    async function testAsk() {
        try {
            const response = await fetch('/api/rag/ask', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded',
                },
                body: 'sessionId=test123&question=你好，这是一个测试问题'
            });

            const data = await response.json();
            document.getElementById('result').innerHTML =
                '<pre>' + JSON.stringify(data, null, 2) + '</pre>';
        } catch (error) {
            document.getElementById('result').innerHTML =
                '错误: ' + error.message;
        }
    }
</script>
<script src="/js/common.js"></script>
</body>
</html>